document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('maintenanceForm');
    const steps = ['step1', 'step2', 'step3'];
    let currentStep = 0;

    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const submitBtn = document.getElementById('submitBtn');

    function showStep(step) {
        steps.forEach((s, index) => {
            const elem = document.getElementById(s);
            elem.classList.toggle('hidden', index !== step);
        });

        prevBtn.classList.toggle('hidden', step === 0);
        nextBtn.classList.toggle('hidden', step === steps.length - 1);
        submitBtn.classList.toggle('hidden', step !== steps.length - 1);
    }

    nextBtn.addEventListener('click', () => {
        if (currentStep < steps.length - 1) {
            currentStep++;
            showStep(currentStep);
        }
    });

    prevBtn.addEventListener('click', () => {
        if (currentStep > 0) {
            currentStep--;
            showStep(currentStep);
        }
    });

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const formData = new FormData(form);
        try {
            const response = await fetch('/submit', {
                method: 'POST',
                body: formData
            });
            const result = await response.json();
            alert(result.message);
        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred. Please try again.');
        }
    });

    showStep(currentStep);
});
